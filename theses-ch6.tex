
\chapter{Conclusion}
\label{ChConclusion}

This chapter concludes the thesis by listing the main contributions of this work. Next, we present directions for future research.



\section{Contributions}
\label{SecContributions}

\begin{enumerate}

\item In Study~1, we found that code reuse is one of the main motivations for applying Extract Method refactoring (56.9\% of the cases).
This was an important finding for two main reasons.
First, the relationship between Extract Method and code reuse, using actual refactorings mined from code repositories, had not been studied before.
Second, although refactoring literature emphasizes code smells as motivations for refactorings, such finding reveals that it is incorrect to assume that they are the sole reason to refactor source code.

\item In Study~2, we compiled a catalogue of 44 distinct motivations for 12 well-known refactoring types, based on the actual explanations of developers on specific refactorings they have recently applied.
Some of the motivations we found are the resolution of well-known code smells, but many others are related to code evolution, facilitating the implementation of a feature or a bug fix.
We also investigated the frequency of each refactoring type and the usage of refactoring tools, confirming previous findings, and how the IDE affects refactoring tools usage.
The findings of this study increased our knowledge about refactoring practice and offered important insights to researchers, practitioners, and refactoring tools builders.

\item We proposed RefDiff, a novel refactoring detection approach suitable to mine refactoring in version histories in large scale with high precision and recall, with the advantage of supporting multiple programming languages.
When initially proposed, our approach improved precision and recall over existing approaches.
Later, we extended RefDiff introducing a language agnostic core algorithm and improved its precision to be on par with RMiner, the current state-of-the-art in Java refactoring detection.
Taking advantage of RefDiff's extensible architecture, we implemented plugins for three programming languages (Java, JavaScript and C), and evaluated our approach in each of them.


\item We contributed to the creation of the largest refactoring dataset to date, which keeps record of 3,248 refactorings mined from 538 commits of 185 Java repositories.
Such dataset initially contained the data we collected in Study~2, and was later extended by \cite{tsantalis2018rminer}, while evaluating RMiner. Finally, in our evaluation of RefDiff, we extended it once again with additional refactorings.
This dataset serves as a reliable oracle that can be used to evaluate precision and recall of refactoring detection approaches, facilitating future research.

\end{enumerate}


\section{Future Work}
\label{SecFutureWork}

